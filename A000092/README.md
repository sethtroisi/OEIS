[A000092](https://oeis.org/A000092) Record differences between number of lattice points in the ball x^2+y^2+z^2 <= n and the volume of this ball rounded to the nearest integer.
---------

For R2 (lattice points in the circle x^2+y^2 <= n) version see [A000099](//oeis.org/A000099).
Code in [../A000099](../A000099)

Code simultaneously calculates a few sequences.

* [A000092](https://oeis.org/A000092) - Record index
* [A000223](https://oeis.org/A000223) - Delta between lattice points at volume of sphere
* [A000413](https://oeis.org/A000413) - Number of lattice points at record

See [A210641](https://oeis.org/A210641) for all deltas.


---

C++ code is 2-4x faster than pypy from use of `inplace_merge`.

Use of openmp speeds up 30% of program by 3x (reducing runtime 20%).

The python code is 30-50x faster with pypy (takes < 2seconds).

```
$ g++ -O3 -march=native -Wall -Werror A000092.cpp && time ./a.out
	   397/7937 pairs: 78210 (0 removed, 61235 fixed, 395 new, 16580 merged, 69999357 processed)
	   794/7937 pairs: 314028 (0 removed, 246271 fixed, 792 new, 66965 merged, 142526493 processed)
		At i=2048, cleared 12582912, max_seen=1111
...
	  7541/7937 pairs: 2406442 (5913 removed, 0 fixed, 0 new, 0 merged, 43185286844 processed)
	  7937/7937 pairs: 1527 (6171 removed, 0 fixed, 0 new, 0 merged, 43667198439 processed)
		At i=7937, cleared 25251265, max_seen=3114
	tuples: 43667199966
	Sum of 0..1000: 132451
	Sum(counts)   : 2094591847575
| nth | n = A000092 | P(n) = A000223 | A(n) = A000413  |
|   1 |           1 |              3 |               7 | -> 2.81121
|   2 |           2 |              7 |              19 | -> 7.15231
...
|  40 |        8382 |           1576 |         3216051 | -> 1575.69220
|  45 |       15734 |           2411 |         8269399 | -> 2410.60355
|  50 |       23894 |           2940 |        15474065 | -> 2939.88295
...
| 100 |     1552324 |         -39136 |      8101399883 | -> 39136.20032
...
| 148 |    57539790 |         303871 |   1828273187987 | -> 303871.30699
| 149 |    58648590 |         313976 |   1881373597529 | -> 313975.62816
| 150 |    59729670 |         318604 |   1933632129897 | -> 318603.99923

# Copy results to README.md

# Errors will print in bold, including a known rounding error at 188 which must be manually fixed
# ERROR with rounding! n=440748004, an=38759139769759
#	-978299 vs -978300 from -978299.5000794
$ pypy validate.py
```

~~It's possible that directly computing R'2(n) using primes would be
significantly faster for [A000099](https://oeis.org/A000099).~~ (Tested and it's
slower)

~~Could be trivially multiprocessed by congruency classes of `i` then summing counts~~
Memory bandwidth limited?

### Results for A000092
---

| nth | n = A000092 | P(n) = A000223 | A(n) = A000413 |
|-----|-------------|----------------|----------------|
|   1 |           1 |              3 |              7 |
|   2 |           2 |              7 |             19 |
|   3 |           5 |             10 |             57 |
|   4 |           6 |             19 |             81 |
|   5 |          14 |             32 |            251 |
|   6 |          21 |             34 |            437 |
|   7 |          29 |             37 |            691 |
|   8 |          30 |             51 |            739 |
|   9 |          54 |             81 |           1743 |
|  10 |          90 |            119 |           3695 |
|  11 |         134 |            122 |           6619 |
|  12 |         155 |            134 |           8217 |
|  13 |         174 |            157 |           9771 |
|  14 |         230 |            160 |          14771 |
|  15 |         234 |            161 |          15155 |
|  16 |         251 |            174 |          16831 |
|  17 |         270 |            221 |          18805 |
|  18 |         342 |            252 |          26745 |
|  19 |         374 |            254 |          30551 |
|  20 |         461 |            294 |          41755 |
|  25 |         810 |            405 |          96969 |
|  30 |        2757 |            763 |         607141 |
|  35 |        4554 |           1120 |        1288415 |
|  40 |        8382 |           1576 |        3216051 |
|  45 |       15734 |           2411 |        8269399 |
|  50 |       23894 |           2940 |       15474065 |
|  55 |       31126 |           3466 |       23005889 |
|  60 |       40986 |           4455 |       34761425 |
|  65 |       78702 |           6813 |       92490953 |
|  70 |      111150 |           8817 |      155230651 |
|  75 |      171990 |          10794 |      298785209 |
|  80 |      219450 |          12836 |      430630645 |
|  85 |      330030 |          17625 |      794197245 |
|  90 |      589050 |          22933 |     1893747659 |
|  95 |      951786 |          29140 |     3889563191 |
| 100 |     1552324 |         -39136 |     8101399883 |
| 105 |     1969110 |          48739 |    11574317851 |
| 110 |     3188009 |          61027 |    23843446359 |
| 111 |     3657654 |          61095 |    29301742369 |
| 112 |     3871062 |          61489 |    31903228695 |
| 113 |     3928320 |         -67781 |    32613543939 |
| 114 |     3928321 |         -69002 |    32613555171 |
| 115 |     4299750 |          77374 |    37346879191 |
| 116 |     4723110 |          80861 |    42996342775 |
| 117 |     6133050 |          85802 |    63621507141 |
| 118 |     7005870 |          86502 |    77675168577 |
| 119 |     7076164 |         -89457 |    78846959585 |
| 120 |     8165850 |          90894 |    97744225607 |
| 121 |     8239766 |          96483 |    99074376945 |
| 122 |     8239770 |         103540 |    99074456145 |
| 123 |     8378370 |         107326 |   101584716133 |
| 124 |     9606870 |         116127 |   124727404335 |
| 125 |    11084850 |         120897 |   154590812543 |
| 126 |    11191950 |         128019 |   156836667491 |
| 127 |    13548149 |         133240 |   208885759113 |
| 128 |    13548150 |         148513 |   208885797513 |
| 129 |    13783770 |         154361 |   214358618109 |
| 130 |    17775450 |         169433 |   313920552309 |
| 131 |    19438650 |         170157 |   358994640909 |
| 132 |    22619524 |        -172992 |   450623290819 |
| 133 |    22972950 |         188617 |   461226166515 |
| 134 |    24250590 |         217133 |   500232911441 |
| 135 |    31505768 |        -219251 |   740753286073 |
| 136 |    31505776 |        -226033 |   740753561431 |
| 137 |    36139950 |         234445 |   910060033667 |
| 138 |    37920961 |        -237917 |   978154609447 |
| 139 |    40494510 |         239737 |  1079401278303 |
| 140 |    40608750 |         240681 |  1083972184137 |
| 141 |    42058170 |         243083 |  1142521180291 |
| 142 |    42577924 |        -251624 |  1163764858835 |
| 143 |    42712110 |         277158 |  1169271197063 |
| 144 |    52702650 |         289924 |  1602645127015 |
| 145 |    54573750 |         291265 |  1688746180679 |
| 146 |    55278724 |        -299451 |  1721573417753 |
| 147 |    57539790 |         304303 |  1828273188419 |
| 148 |    58648590 |         314408 |  1881373597961 |
| 149 |    59729670 |         319036 |  1933632130329 |
| 150 |    62899200 |        -322249 |  2089566634657 |
| 151 |    62899204 |        -334135 |  2089566822097 |
| 152 |    69189120 |        -336369 |  2410711608203 |
| 153 |    69189124 |        -348089 |  2410711805537 |
| 154 |    72981090 |         364972 |  2611585136077 |
| 155 |    79858350 |         365868 |  2989297655873 |
| 156 |    80187030 |         371780 |  3007771606665 |
| 157 |    84636090 |         379050 |  3261535029903 |
| 158 |    85451520 |        -424075 |  3308782667347 |
| 159 |   101122564 |        -429121 |  4259520127075 |
| 160 |   112342230 |         437103 |  4987733125091 |
| 161 |   114029370 |         440327 |  5100511535797 |
| 162 |   114864750 |         449251 |  5156663647095 |
| 163 |   116666549 |         470430 |  5278471432091 |
| 164 |   116666550 |         543684 |  5278471573211 |
| 165 |   133056004 |        -563688 |  6428953518029 |
| 166 |   149385604 |        -564833 |  7648067254117 |
| 167 |   161056350 |         581610 |  8561609540193 |
| 168 |   187821270 |         594548 | 10782160503681 |
| 169 |   199180800 |        -602102 | 11774969629099 |
| 170 |   200901124 |        -606811 | 11927849122799 |
| 171 |   203845950 |         607527 | 12191068231355 |
| 172 |   206236804 |        -612061 | 12406173279233 |
| 173 |   209999790 |         651399 | 12747262293827 |
| 174 |   217075950 |         741411 | 13396958091879 |
| 175 |   263672644 |        -753217 | 17934373176553 |
| 176 |   279370350 |         785890 | 19559560614821 |
| 177 |   285508608 |        -807333 | 20207724013973 |
| 178 |   285508609 |        -812118 | 20207724115355 |
| 179 |   305585284 |        -814360 | 22376247022321 |
| 180 |   305585288 |        -818873 | 22376247457153 |
| 181 |   311875200 |        -861275 | 23070651309519 |
| 182 |   311875204 |        -865055 | 23070651749583 |
| 183 |   311875207 |        -890738 | 23070652056783 |
| 184 |   311875208 |        -917987 | 23070652140495 |
| 185 |   331531201 |        -935147 | 25285712960947 |
| 186 |   331531204 |        -955607 | 25285713283699 |
| 187 |   408038404 |        -975336 | 34525514354247 |
| 188 |   440748004 |        -978300 | 38759139769759 |
| 189 |   454013910 |        1011005 | 40522138677555 |
| 190 |   461260800 |       -1075057 | 41496208764193 |
| 191 |   461260801 |       -1082705 | 41496208891489 |
| 192 |   461260803 |       -1098289 | 41496209145793 |
| 193 |   461260804 |       -1157200 | 41496209221825 |
| 194 |   574452270 |        1157583 | 57672601616367 |
| 195 |   623750400 |       -1225777 | 65253657159681 |
| 196 |   623750408 |       -1245637 | 65253658395201 |
| 197 |   698544004 |       -1307640 | 77335563756279 |
| 198 |   716338350 |        1322289 | 80309314669061 |
| 199 |   795945150 |        1387651 | 94061808998805 |
| 200 |   859541764 |       -1392532 | 105557495778871 |
| 201 |   864864000 |       -1397686 | 106539421320713 |
| 202 |   864864004 |       -1442484 | 106539422015033 |
| 203 |   875508484 |       -1507814 | 108512343190665 |
| 204 |   961918650 |        1574416 | 124967226814085 |
| 205 |  1066665604 |       -1610522 | 145925449886943 |
| 206 |  1066665608 |       -1626202 | 145925450692095 |
| 207 |  1153152004 |       -1634227 | 164028170914633 |
| 208 |  1195084799 |       -1660883 | 173056010939327 |
| 209 |  1195084800 |       -1867341 | 173056010950079 |
| 210 |  1381272750 |        1934766 | 215034319698747 |
| 211 |  1452971524 |       -1957645 | 231992668259819 |
| 212 |  1542250710 |        2002520 | 253700358552191 |
| 213 |  1662111360 |       -2128333 | 283843388465489 |
| 214 |  1662111361 |       -2130854 | 283843388719127 |
| 215 |  1662111364 |       -2204340 | 283843389414119 |
| 216 |  1729728000 |       -2235504 | 301338990836015 |
| 217 |  1729728001 |       -2239014 | 301338991093823 |
| 218 |  1729728004 |       -2244503 | 301338991872287 |
| 219 |  1930376449 |       -2273813 | 355264344290901 |
| 220 |  2022390720 |       -2292182 | 380965986286889 |
| 221 |  2029277250 |        2363425 | 382913512107279 |
| 222 |  2179629270 |        2465817 | 426248200819061 |
| 223 |  2179629275 |        2476725 | 426248202296669 |
| 224 |  2288043450 |        2615352 | 458442648622467 |
| 225 |  2390280750 |        2627952 | 489510466936637 |
| 226 |  2519637124 |       -2760548 | 529780055978287 |
| 227 |  2774661124 |       -2877555 | 612214386854755 |
| 228 |  2893363204 |       -2890345 | 651918099145955 |
| 229 |  3000412804 |       -2907076 | 688430531241105 |
| 230 |  3126088350 |        3082090 | 732133843702927 |
| 231 |  3295041750 |        3174899 | 792282372875473 |
| 232 |  3433140484 |       -3212683 | 842608760857963 |
| 233 |  3470611204 |       -3251931 | 856441205969595 |
| 234 |  3644590950 |        3302788 | 921641027638237 |
| 235 |  3979725750 |        3408322 | 1051642982933555 |
| 236 |  4218762244 |       -3536345 | 1147799903482615 |
| 237 |  4410806400 |       -3538395 | 1227059443486299 |
| 238 |  4410806404 |       -3596871 | 1227059445096987 |
| 239 |  4508824324 |       -3665265 | 1268187825177339 |
| 240 |  4759135290 |        3683905 | 1375246938256269 |
| 241 |  4866668730 |        3762604 | 1422120144313479 |
| 242 |  5039274244 |       -3871354 | 1498444282631079 |
| 243 |  5079110404 |       -3879452 | 1516247465399943 |
| 244 |  5099552640 |       -3881630 | 1525410483913711 |
| 245 |  5099552644 |       -3943971 | 1525410485646127 |
| 246 |  5594957550 |        3985233 | 1753007620395199 |
| 247 |  5786726401 |       -3996143 | 1843902835570625 |
| 248 |  5786726404 |       -4137207 | 1843902836863457 |
| 249 |  5812156350 |        4224193 | 1856070819999815 |
| 250 |  5840976960 |       -4280865 | 1869893397021697 |
| 251 |  5967561600 |       -4368375 | 1931007561306491 |
| 252 |  5967561601 |       -4396599 | 1931007561763643 |
| 253 |  5967561604 |       -4573767 | 1931007563042603 |
